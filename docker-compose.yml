---
version: '3.9'

services:
  front:
    image: nginx
    working_dir: /opt/src
    ports:
      - "8000:80"
    volumes:
      - ./nginx:/var/www/html
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf
     
    links:
        - php
  php:
    image: php:8-fpm
    volumes:
        - ./nginx:/var/www/html
        - /opt/files:/opt/files
  back:
    build:
      context: .
      dockerfile: ./Dockerfile
    environment:
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
    volumes:
      - /opt/files:/opt/files

